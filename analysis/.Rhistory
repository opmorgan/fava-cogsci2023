# input_files
# n_input_files <- length(input_files)
# n_input_files
# input_path <- input_files[1] ## This will be in s a loop
# input_path
# data_raw <- load_raw(input_path, data_type)
# data_raw
# subject_id <- data_raw$subject %>% first() %>% as.character()
# subject_id
# data_raw
# data_recoded <- recode_raw(data_raw, data_type)
# data_recoded
# data_cleaned <- clean_recoded(data_recoded, data_type)
# data_cleaned
# data_tests(data_cleaned, data_type)
# save_cleaned(data_cleaned, proc_dir, data_type)
# Chunk 7: calculate_variables
## Load processed data
ind_input_dir <- here(proc_dir, "individual")
summary_output_dir <- here(proc_dir, "summary")
## Create summary row for each subject
## TODO: Add overall median RT to summary spreadsheet
if (resummarize_task_data == TRUE) {
## Create summarized task data (saves to tsv as a side effect)
task_summary <-
load_and_summarize_proc(ind_input_dir, summary_output_dir,
data_type = "task")
}
if (resummarize_ehi_data == TRUE) {
## Create summarized task data (saves to tsv as a side effect)
ehi_summary <-
load_and_summarize_proc(ind_input_dir, summary_output_dir,
data_type = "ehi")
}
## TODO: (URGENT) fix logic for race variable -- always shows "multiple"
if (resummarize_demographics_data == TRUE) {
## Create summarized demographics data (saves to tsv as a side effect)
demo_summary <-
load_and_summarize_proc(ind_input_dir, summary_output_dir,
data_type = "demographics")
}
if (resummarize_end_data == TRUE) {
## Create summarized end question data (saves to tsv as a side effect)
end_summary <-
load_and_summarize_proc(ind_input_dir, summary_output_dir,
data_type = "end")
}
# Chunk 8: debug_summary
# group_summary <- tibble(
#   subject = as.character(),
#   ehi_i1_writing = as.numeric(),
#   ehi_i2_throwing = as.numeric(),
#   ehi_i3_toothbrush = as.numeric(),
#   ehi_i4_spoon = as.numeric(),
#   ehi_total = as.numeric()
# )
#
#
# group_summary <- tibble(
#   subject = as.character(),
#   age = as.numeric(),
#   country = as.character(),
#   sex = as.character(),
#   education = as.character(),
#   race = as.character(),
#   hispanic_ethnicity = as.character()
# )
#
# group_summary <- tibble(
#   subject = as.character(),
#   task_experience_response = as.character(),
#   task_experience_other_response = as.character(),
#   open_ended_feedback_response = as.character()
# )
#
# group_summary <- tibble(
#   subject = as.character(),
#   first_block = as.character(),
#   acc_slash = as.numeric(),
#   acc_z = as.numeric(),
#   acc_absent = as.numeric(),
#   acc_present = as.numeric(),
#   acc_global_LVF = as.numeric(),
#   acc_global_RVF = as.numeric(),
#   acc_local_LVF = as.numeric(),
#   acc_local_RVF = as.numeric(),
#   rt_global_LVF = as.numeric(),
#   rt_global_RVF = as.numeric(),
#   rt_local_LVF = as.numeric(),
#   rt_local_RVF = as.numeric(),
#   exclude_many_gos = as.logical(),
#   exclude_low_acc = as.logical(),
#   exclude_low_rt = as.logical(),
#   exclude_high_rt = as.logical(),
#   exclude = as.logical()
# )
#
# data_type = "task"
# input_files <- get_input_paths(ind_input_dir, data_type = data_type,
#                                pattern = "*.tsv")
#
# input_path <- input_files[1]
# input_path
# ind_proc <- load_proc(input_path, data_type = data_type)
#
# duration_s <- last(ind_proc$time_elapsed_ms) / 1000
# duration_s
#
#
# ind_summary <- summarize_ind(ind_proc, data_type = data_type)
# ind_summary
#
#
# group_summary <- group_summary %>% add_row(ind_summary)
# group_summary
# Chunk 9: combine
## Combine summaries into one big table, with a wide row for each subject.
summary <- task_summary %>%
left_join(ehi_summary) %>%
left_join(demo_summary) %>%
left_join(end_summary)
write_tsv(summary, here::here(summary_output_dir, "summary.tsv"))
# Chunk 10: analyze_rt
## Reaction time analyses
# Chunk 11: report_rt
## Visualize per-trial RT data (make absent one color, present another)
## Report RT data by condition
# Chunk 12: report_acc
## Report accuracy data by condition
# Chunk 13: report_duration
## Report experiment duration
# Chunk 14: report_demographics
## Summarize demographic data
## And "end question" responses
# Chunk 15
## Create individual summary data
## Add to a summary spreadsheet
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE,
fig.align = "center", fig.width = 9,
fig.height = 6, results = "asis")
options(knitr.kable.NA = "")
cli.progress_show_after <- 0
# Suppress summarise info
options(dplyr.summarise.inform = FALSE)
library(here)
library(readr)
library(cli) # For printing error messages
data_dir <- here::here("data")
proc_dir <- here::here(data_dir, "proc_prepilot")
## Load combined trial-per-row data
aah <- readr::read_tsv(here(proc_dir, "combined", "combined.tsv"),
col_types = cols(
subject = col_character(),
time_elapsed_ms = col_double(),
blocknum = col_double(),
block_type = col_character(),
block_response = col_character(),
trialnum = col_double(),
target = col_character(),
level = col_character(),
field = col_character(),
target_present = col_character(),
response = col_character(),
correct = col_double(),
rt = col_double(),
ehi_i1_writing = col_double(),
ehi_i2_throwing = col_double(),
ehi_i3_toothbrush = col_double(),
ehi_i4_spoon = col_double(),
ehi_total = col_double(),
age = col_double(),
country = col_character(),
sex = col_character(),
education = col_double(),
race = col_character(),
hispanic_ethnicity = col_character(),
task_experience_response = col_character(),
task_experience_other_response = col_character(),
open_ended_feedback_response = col_character()
)
)
## Reaction time analyses.
## Linear model using data from every trial.
## (1) Binary handedness
aah
## Load combined trial-per-row data
aah
## Load combined trial-per-row data
## TODO: add duration_s (and other missing calculated variables?) to this table
## TODO: add task_experience_response, total duration to exclusion criteria.
aah <- readr::read_tsv(
here(proc_dir, "combined", "combined.tsv"),
col_types = cols(
subject = col_character(),
time_elapsed_ms = col_double(),
blocknum = col_double(),
block_type = col_character(),
block_response = col_character(),
trialnum = col_double(),
target = col_character(),
level = col_character(),
field = col_character(),
target_present = col_character(),
response = col_character(),
correct = col_double(),
rt = col_double(),
ehi_i1_writing = col_double(),
ehi_i2_throwing = col_double(),
ehi_i3_toothbrush = col_double(),
ehi_i4_spoon = col_double(),
ehi_total = col_double(),
age = col_double(),
country = col_character(),
sex = col_character(),
education = col_double(),
race = col_character(),
hispanic_ethnicity = col_character(),
task_experience_response = col_character(),
task_experience_other_response = col_character(),
open_ended_feedback_response = col_character()
)
) %>%
filter(block_type == "main" & target_present == "present") %>%
select(
subject,
block_response,
target,
level,
field,
correct,
rt,
ehi_total,
age,
country,
sex,
education,
race,
open_ended_feedback_response
)
library(tidyr)
## Load combined trial-per-row data
## TODO: add duration_s (and other missing calculated variables?) to this table
## TODO: add task_experience_response, total duration to exclusion criteria.
aah <- readr::read_tsv(
here(proc_dir, "combined", "combined.tsv"),
col_types = cols(
subject = col_character(),
time_elapsed_ms = col_double(),
blocknum = col_double(),
block_type = col_character(),
block_response = col_character(),
trialnum = col_double(),
target = col_character(),
level = col_character(),
field = col_character(),
target_present = col_character(),
response = col_character(),
correct = col_double(),
rt = col_double(),
ehi_i1_writing = col_double(),
ehi_i2_throwing = col_double(),
ehi_i3_toothbrush = col_double(),
ehi_i4_spoon = col_double(),
ehi_total = col_double(),
age = col_double(),
country = col_character(),
sex = col_character(),
education = col_double(),
race = col_character(),
hispanic_ethnicity = col_character(),
task_experience_response = col_character(),
task_experience_other_response = col_character(),
open_ended_feedback_response = col_character()
)
) %>%
filter(block_type == "main" & target_present == "present") %>%
select(
subject,
block_response,
target,
level,
field,
correct,
rt,
ehi_total,
age,
country,
sex,
education,
race,
open_ended_feedback_response
)
library(dplyr)
library(tidyverse)
install.packages("stringi")
library(tidyverse)
data_dir <- here::here("data")
proc_dir <- here::here(data_dir, "proc_prepilot")
## Load combined trial-per-row data
## TODO: add duration_s (and other missing calculated variables?) to this table
## TODO: add task_experience_response, total duration to exclusion criteria.
aah <- readr::read_tsv(
here(proc_dir, "combined", "combined.tsv"),
col_types = cols(
subject = col_character(),
time_elapsed_ms = col_double(),
blocknum = col_double(),
block_type = col_character(),
block_response = col_character(),
trialnum = col_double(),
target = col_character(),
level = col_character(),
field = col_character(),
target_present = col_character(),
response = col_character(),
correct = col_double(),
rt = col_double(),
ehi_i1_writing = col_double(),
ehi_i2_throwing = col_double(),
ehi_i3_toothbrush = col_double(),
ehi_i4_spoon = col_double(),
ehi_total = col_double(),
age = col_double(),
country = col_character(),
sex = col_character(),
education = col_double(),
race = col_character(),
hispanic_ethnicity = col_character(),
task_experience_response = col_character(),
task_experience_other_response = col_character(),
open_ended_feedback_response = col_character()
)
) %>%
filter(block_type == "main" & target_present == "present") %>%
select(
subject,
block_response,
target,
level,
field,
correct,
rt,
ehi_total,
age,
country,
sex,
education,
race,
open_ended_feedback_response
)
aah
## Load combined trial-per-row data
## TODO: add duration_s (and other missing calculated variables?) to this table
## TODO: add task_experience_response, total duration to exclusion criteria.
aah <- readr::read_tsv(
here(proc_dir, "combined", "combined.tsv"),
col_types = cols(
subject = col_character(),
time_elapsed_ms = col_double(),
blocknum = col_double(),
block_type = col_character(),
block_response = col_character(),
trialnum = col_double(),
target = col_character(),
level = col_character(),
field = col_character(),
target_present = col_character(),
response = col_character(),
correct = col_double(),
rt = col_double(),
ehi_i1_writing = col_double(),
ehi_i2_throwing = col_double(),
ehi_i3_toothbrush = col_double(),
ehi_i4_spoon = col_double(),
ehi_total = col_double(),
age = col_double(),
country = col_character(),
sex = col_character(),
education = col_double(),
race = col_character(),
hispanic_ethnicity = col_character(),
task_experience_response = col_character(),
task_experience_other_response = col_character(),
open_ended_feedback_response = col_character()
)
) %>%
filter(block_type == "main" & target_present == "present") %>%
select(
subject,
block_response,
target,
level,
field,
correct,
rt,
ehi_total,
age,
country,
sex,
education,
race,
open_ended_feedback_response
)
aah
## Load combined trial-per-row data
## TODO: add duration_s (and other missing calculated variables?) to this table
## TODO: add task_experience_response, total duration to exclusion criteria.
aah <- readr::read_tsv(
here(proc_dir, "combined", "combined.tsv"),
col_types = cols(
subject = col_character(),
time_elapsed_ms = col_double(),
blocknum = col_double(),
block_type = col_character(),
block_response = col_character(),
trialnum = col_double(),
target = col_character(),
level = col_character(),
field = col_character(),
target_present = col_character(),
response = col_character(),
correct = col_double(),
rt = col_double(),
ehi_i1_writing = col_double(),
ehi_i2_throwing = col_double(),
ehi_i3_toothbrush = col_double(),
ehi_i4_spoon = col_double(),
ehi_total = col_double(),
age = col_double(),
country = col_character(),
sex = col_character(),
education = col_double(),
race = col_character(),
hispanic_ethnicity = col_character(),
task_experience_response = col_character(),
task_experience_other_response = col_character(),
open_ended_feedback_response = col_character()
)
)
# filter(block_type == "main" & target_present == "present") %>%
# select(
#   subject,
#   block_response,
#   target,
#   level,
#   field,
#   correct,
#   rt,
#   ehi_total,
#   age,
#   country,
#   sex,
#   education,
#   race,
#   open_ended_feedback_response
# )
aah
aah
## Load combined trial-per-row data
## TODO: add duration_s (and other missing calculated variables?) to this table
## TODO: add task_experience_response, total duration to exclusion criteria.
aah <- readr::read_tsv(
here(proc_dir, "combined", "combined.tsv"),
col_types = cols(
subject = col_character(),
time_elapsed_ms = col_double(),
blocknum = col_double(),
block_type = col_character(),
block_response = col_character(),
trialnum = col_double(),
target = col_character(),
level = col_character(),
field = col_character(),
target_present = col_character(),
response = col_character(),
correct = col_double(),
rt = col_double(),
ehi_i1_writing = col_double(),
ehi_i2_throwing = col_double(),
ehi_i3_toothbrush = col_double(),
ehi_i4_spoon = col_double(),
ehi_total = col_double(),
age = col_double(),
country = col_character(),
sex = col_character(),
education = col_double(),
race = col_character(),
hispanic_ethnicity = col_character(),
task_experience_response = col_character(),
task_experience_other_response = col_character(),
open_ended_feedback_response = col_character()
)
) %>%
filter(block_type == "main" & target_present == "yes") %>%
select(
subject,
block_response,
target,
level,
field,
correct,
rt,
ehi_total,
age,
country,
sex,
education,
race,
open_ended_feedback_response
)
aah
aah %>% filter(block_type == "main" & target_present == "present")
